<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>An√°lisis de tweets - Topics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@*/dist/embed-amd.js" crossorigin="anonymous"></script>


</head>

<body class="nav-sidebar docked fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">
      An√°lisis de tweets
      </li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">An√°lisis de tweets</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Websites</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../websites/index.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../websites/navigation.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Navigation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../websites/styling.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Styling</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Embedding</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../embedding/r-and-python.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">R and Python</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../embedding/observable.qmd" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Interactive graphics with Observable</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Topics</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> spacy</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> preprocessor <span class="im">as</span> p</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> emoji <span class="im">import</span> demojize</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> bertopic <span class="im">import</span> BERTopic</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages/umap/distances.py:1063: NumbaDeprecationWarning:

The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.

/home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages/umap/distances.py:1071: NumbaDeprecationWarning:

The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.

/home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages/umap/distances.py:1086: NumbaDeprecationWarning:

The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.

/home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages/umap/umap_.py:660: NumbaDeprecationWarning:

The 'nopython' keyword argument was not supplied to the 'numba.jit' decorator. The implicit default value for this argument is currently False, but it will be changed to True in Numba 0.59.0. See https://numba.readthedocs.io/en/stable/reference/deprecation.html#deprecation-of-object-mode-fall-back-behaviour-when-using-jit for details.
</code></pre>
</div>
</div>
<div class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>python <span class="op">-</span>m spacy download es_core_news_sm</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># load the spacy model for Spanish</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>nlp <span class="op">=</span> spacy.load(<span class="st">"es_core_news_sm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Collecting es-core-news-sm==3.5.0
  Downloading https://github.com/explosion/spacy-models/releases/download/es_core_news_sm-3.5.0/es_core_news_sm-3.5.0-py3-none-any.whl (12.9 MB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 12.9/12.9 MB 22.6 MB/s eta 0:00:00m eta 0:00:010:01:01
Requirement already satisfied: spacy&lt;3.6.0,&gt;=3.5.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from es-core-news-sm==3.5.0) (3.5.4)
Requirement already satisfied: pydantic!=1.8,!=1.8.1,&lt;1.11.0,&gt;=1.7.4 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.10.9)
Requirement already satisfied: packaging&gt;=20.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (23.1)
Requirement already satisfied: setuptools in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (68.0.0)
Requirement already satisfied: srsly&lt;3.0.0,&gt;=2.4.3 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2.4.6)
Requirement already satisfied: preshed&lt;3.1.0,&gt;=3.0.2 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.0.8)
Requirement already satisfied: murmurhash&lt;1.1.0,&gt;=0.28.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.0.9)
Requirement already satisfied: typer&lt;0.10.0,&gt;=0.3.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (0.9.0)
Requirement already satisfied: langcodes&lt;4.0.0,&gt;=3.2.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.3.0)
Requirement already satisfied: tqdm&lt;5.0.0,&gt;=4.38.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (4.65.0)
Requirement already satisfied: numpy&gt;=1.15.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.24.4)
Requirement already satisfied: wasabi&lt;1.2.0,&gt;=0.9.1 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.1.2)
Requirement already satisfied: spacy-loggers&lt;2.0.0,&gt;=1.0.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.0.4)
Requirement already satisfied: cymem&lt;2.1.0,&gt;=2.0.2 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2.0.7)
Requirement already satisfied: jinja2 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.1.2)
Requirement already satisfied: thinc&lt;8.2.0,&gt;=8.1.8 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (8.1.10)
Requirement already satisfied: pathy&gt;=0.10.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (0.10.2)
Requirement already satisfied: spacy-legacy&lt;3.1.0,&gt;=3.0.11 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.0.12)
Requirement already satisfied: requests&lt;3.0.0,&gt;=2.13.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2.31.0)
Requirement already satisfied: smart-open&lt;7.0.0,&gt;=5.2.1 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (6.3.0)
Requirement already satisfied: catalogue&lt;2.1.0,&gt;=2.0.6 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2.0.8)
Requirement already satisfied: typing-extensions&gt;=4.2.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from pydantic!=1.8,!=1.8.1,&lt;1.11.0,&gt;=1.7.4-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (4.7.0)
Requirement already satisfied: certifi&gt;=2017.4.17 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2023.5.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (1.26.16)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.1.0)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from requests&lt;3.0.0,&gt;=2.13.0-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (3.4)
Requirement already satisfied: blis&lt;0.8.0,&gt;=0.7.8 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from thinc&lt;8.2.0,&gt;=8.1.8-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (0.7.9)
Requirement already satisfied: confection&lt;1.0.0,&gt;=0.0.1 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from thinc&lt;8.2.0,&gt;=8.1.8-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (0.1.0)
Requirement already satisfied: click&lt;9.0.0,&gt;=7.1.1 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from typer&lt;0.10.0,&gt;=0.3.0-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (8.1.3)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /home/fxr/.local/share/virtualenvs/capir_transfronteriza2_2023-f1a4fPBO/lib/python3.8/site-packages (from jinja2-&gt;spacy&lt;3.6.0,&gt;=3.5.0-&gt;es-core-news-sm==3.5.0) (2.1.3)
Installing collected packages: es-core-news-sm
Successfully installed es-core-news-sm-3.5.0

[notice] A new release of pip is available: 23.0.1 -&gt; 23.1.2
[notice] To update, run: pip install --upgrade pip
‚úî Download and installation successful
You can now load the package via spacy.load('es_core_news_sm')</code></pre>
</div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'../data/processed/tweets.csv'</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(df))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>/tmp/ipykernel_136199/1855968218.py:1: DtypeWarning:

Columns (6,10,18,19,20,26,28,38,39,40,45,46,47,48,54) have mixed types. Specify dtype option on import or set low_memory=False.
</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>200827</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split column into two columns after '|'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">'date'</span>, <span class="st">'time'</span>]] <span class="op">=</span> df[<span class="st">'local_time'</span>].<span class="bu">str</span>.split(<span class="st">'T'</span>, expand<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">query</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">timestamp_utc</th>
<th data-quarto-table-cell-role="th">local_time</th>
<th data-quarto-table-cell-role="th">user_screen_name</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">possibly_sensitive</th>
<th data-quarto-table-cell-role="th">retweet_count</th>
<th data-quarto-table-cell-role="th">like_count</th>
<th data-quarto-table-cell-role="th">reply_count</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">media_alt_texts</th>
<th data-quarto-table-cell-role="th">mentioned_names</th>
<th data-quarto-table-cell-role="th">mentioned_ids</th>
<th data-quarto-table-cell-role="th">hashtags</th>
<th data-quarto-table-cell-role="th">intervention_type</th>
<th data-quarto-table-cell-role="th">intervention_text</th>
<th data-quarto-table-cell-role="th">intervention_url</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>from:TommyZambranoM</td>
<td>1.638175e+18</td>
<td>1679406309</td>
<td>2023-03-21T13:45:09</td>
<td>TommyZambranoM</td>
<td>Los Nacionalistas para lograr la renovaci√≥n de...</td>
<td>0.0</td>
<td>30.0</td>
<td>117.0</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>pnh_oficial</td>
<td>201589327</td>
<td>librenuncamas</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Honduras</td>
<td>2023-03-21</td>
<td>13:45:09</td>
</tr>
</tbody>
</table>

<p>1 rows √ó 64 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert 'date' column to datetime format</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'date'</span>] <span class="op">=</span> pd.to_datetime(df[<span class="st">'date'</span>], <span class="bu">format</span><span class="op">=</span><span class="st">'%Y-%m-</span><span class="sc">%d</span><span class="st">'</span>, errors<span class="op">=</span><span class="st">'coerce'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(200827, 64)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="28">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">query</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">timestamp_utc</th>
<th data-quarto-table-cell-role="th">local_time</th>
<th data-quarto-table-cell-role="th">user_screen_name</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">possibly_sensitive</th>
<th data-quarto-table-cell-role="th">retweet_count</th>
<th data-quarto-table-cell-role="th">like_count</th>
<th data-quarto-table-cell-role="th">reply_count</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">media_alt_texts</th>
<th data-quarto-table-cell-role="th">mentioned_names</th>
<th data-quarto-table-cell-role="th">mentioned_ids</th>
<th data-quarto-table-cell-role="th">hashtags</th>
<th data-quarto-table-cell-role="th">intervention_type</th>
<th data-quarto-table-cell-role="th">intervention_text</th>
<th data-quarto-table-cell-role="th">intervention_url</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>from:TommyZambranoM</td>
<td>1.638175e+18</td>
<td>1679406309</td>
<td>2023-03-21T13:45:09</td>
<td>TommyZambranoM</td>
<td>Los Nacionalistas para lograr la renovaci√≥n de...</td>
<td>0.0</td>
<td>30.0</td>
<td>117.0</td>
<td>58.0</td>
<td>...</td>
<td>NaN</td>
<td>pnh_oficial</td>
<td>201589327</td>
<td>librenuncamas</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Honduras</td>
<td>2023-03-21</td>
<td>13:45:09</td>
</tr>
</tbody>
</table>

<p>1 rows √ó 64 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador <span class="op">=</span> df[df[<span class="st">'user_screen_name'</span>] <span class="op">==</span> <span class="st">'_FamiliaEcuador'</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(_FamiliaEcuador.shape)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador.sort_values(by<span class="op">=</span><span class="st">'date'</span>, ascending<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(2716, 64)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">query</th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">timestamp_utc</th>
<th data-quarto-table-cell-role="th">local_time</th>
<th data-quarto-table-cell-role="th">user_screen_name</th>
<th data-quarto-table-cell-role="th">text</th>
<th data-quarto-table-cell-role="th">possibly_sensitive</th>
<th data-quarto-table-cell-role="th">retweet_count</th>
<th data-quarto-table-cell-role="th">like_count</th>
<th data-quarto-table-cell-role="th">reply_count</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">media_alt_texts</th>
<th data-quarto-table-cell-role="th">mentioned_names</th>
<th data-quarto-table-cell-role="th">mentioned_ids</th>
<th data-quarto-table-cell-role="th">hashtags</th>
<th data-quarto-table-cell-role="th">intervention_type</th>
<th data-quarto-table-cell-role="th">intervention_text</th>
<th data-quarto-table-cell-role="th">intervention_url</th>
<th data-quarto-table-cell-role="th">country</th>
<th data-quarto-table-cell-role="th">date</th>
<th data-quarto-table-cell-role="th">time</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">199415</td>
<td>from:_FamiliaEcuador</td>
<td>1.023353e+18</td>
<td>1532821281</td>
<td>2018-07-28T23:41:21</td>
<td>_FamiliaEcuador</td>
<td>https://twitter.com/RedFamiliarPF/status/10233...</td>
<td>0.0</td>
<td>2.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2018-07-28</td>
<td>23:41:21</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">199410</td>
<td>from:_FamiliaEcuador</td>
<td>1.023357e+18</td>
<td>1532822381</td>
<td>2018-07-28T23:59:41</td>
<td>_FamiliaEcuador</td>
<td>@Lenin @AsambleaEcuador @Educacion_Ec ¬øEs este...</td>
<td>0.0</td>
<td>2.0</td>
<td>2.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>asambleaecuador|educacion_ec|lenin</td>
<td>56502954|360682978|913131817</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2018-07-28</td>
<td>23:59:41</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199411</td>
<td>from:_FamiliaEcuador</td>
<td>1.023354e+18</td>
<td>1532821576</td>
<td>2018-07-28T23:46:16</td>
<td>_FamiliaEcuador</td>
<td>https://twitter.com/RedFamiliarPF/status/10233...</td>
<td>0.0</td>
<td>2.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2018-07-28</td>
<td>23:46:16</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">199414</td>
<td>from:_FamiliaEcuador</td>
<td>1.023353e+18</td>
<td>1532821310</td>
<td>2018-07-28T23:41:50</td>
<td>_FamiliaEcuador</td>
<td>https://twitter.com/RedFamiliarPF/status/10233...</td>
<td>0.0</td>
<td>2.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2018-07-28</td>
<td>23:41:50</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">199413</td>
<td>from:_FamiliaEcuador</td>
<td>1.023353e+18</td>
<td>1532821350</td>
<td>2018-07-28T23:42:30</td>
<td>_FamiliaEcuador</td>
<td>https://twitter.com/RedFamiliarPF/status/10233...</td>
<td>0.0</td>
<td>1.0</td>
<td>1.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2018-07-28</td>
<td>23:42:30</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">196704</td>
<td>from:_FamiliaEcuador</td>
<td>1.636195e+18</td>
<td>1678934298</td>
<td>2023-03-16T02:38:18</td>
<td>_FamiliaEcuador</td>
<td>üö®#URGENTE | Toda Latinoam√©rica corre peligro e...</td>
<td>0.0</td>
<td>31.0</td>
<td>47.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>frenemoselaborto|urgente</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2023-03-16</td>
<td>02:38:18</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">196703</td>
<td>from:_FamiliaEcuador</td>
<td>1.637191e+18</td>
<td>1679171738</td>
<td>2023-03-18T20:35:38</td>
<td>_FamiliaEcuador</td>
<td>üö® EL SALVADOR BAJO ATAQUE DE LA CIDH\nüéôPablo M...</td>
<td>0.0</td>
<td>26.0</td>
<td>26.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>dignidadok|globalcenter4hr|pmunoziturrieta</td>
<td>1268014327057047553|1547733636144701445|957037...</td>
<td>frenemoselaborto</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2023-03-18</td>
<td>20:35:38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">196702</td>
<td>from:_FamiliaEcuador</td>
<td>1.637535e+18</td>
<td>1679253660</td>
<td>2023-03-19T19:21:00</td>
<td>_FamiliaEcuador</td>
<td>üí•üé¨ NUEVO VIDEO DE AGUST√çN LAJE @AgustinLaje\n\...</td>
<td>0.0</td>
<td>5.0</td>
<td>12.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>agustinlaje</td>
<td>175273213</td>
<td>frenemoselaborto</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2023-03-19</td>
<td>19:21:00</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">196701</td>
<td>from:_FamiliaEcuador</td>
<td>1.637578e+18</td>
<td>1679264008</td>
<td>2023-03-19T22:13:28</td>
<td>_FamiliaEcuador</td>
<td>üéôÔ∏è SOMOS VIDA PODCAST\n\nüìå CASO BEATRIZ VS EL...</td>
<td>0.0</td>
<td>13.0</td>
<td>22.0</td>
<td>1.0</td>
<td>...</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>frenemoselaborto</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2023-03-19</td>
<td>22:13:28</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">196700</td>
<td>from:_FamiliaEcuador</td>
<td>1.637861e+18</td>
<td>1679331421</td>
<td>2023-03-20T16:57:01</td>
<td>_FamiliaEcuador</td>
<td>üì£ Jueces de la @CorteIDH no impongan derechos ...</td>
<td>0.0</td>
<td>18.0</td>
<td>25.0</td>
<td>0.0</td>
<td>...</td>
<td>NaN</td>
<td>corteidh</td>
<td>190706828</td>
<td>am√©ricalatinaesprovida|frenemoselaborto</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>Ecuador</td>
<td>2023-03-20</td>
<td>16:57:01</td>
</tr>
</tbody>
</table>

<p>2716 rows √ó 64 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>domains_list <span class="op">=</span> _FamiliaEcuador[<span class="st">'domains'</span>].value_counts()</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>top_domains <span class="op">=</span> domains_list.nlargest(<span class="dv">20</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>top_domains</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>domains
youtu.be                           63
bit.ly                             43
facebook.com                       30
instagram.com                      25
youtube.com                        19
aciprensa.com                      19
eluniverso.com                     18
ecuadorporlafamilia.org            14
arquidiocesisdeguayaquil.org.ec    11
citizengo.org                      11
familiaecuador.org                 10
twitter.com                         9
open.spotify.com                    8
liveaction.org                      6
foxnews.com                         6
expreso.ec                          5
pscp.tv                             5
buff.ly                             5
drive.google.com                    5
forms.gle                           4
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>hashtags <span class="op">=</span> _FamiliaEcuador[<span class="st">'hashtags'</span>].to_list()</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove nan items from list</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>hashtags <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> hashtags <span class="cf">if</span> <span class="kw">not</span> pd.isna(x)]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split items into a list based on a delimiter</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>hashtags <span class="op">=</span> [x.split(<span class="st">'|'</span>) <span class="cf">for</span> x <span class="kw">in</span> hashtags]</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="co"># flatten list of lists</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>hashtags <span class="op">=</span> [item <span class="cf">for</span> sublist <span class="kw">in</span> hashtags <span class="cf">for</span> item <span class="kw">in</span> sublist]</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># count items on list</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>hashtags_count <span class="op">=</span> pd.Series(hashtags).value_counts()</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>top_hashtags <span class="op">=</span> hashtags_count.nlargest(<span class="dv">20</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>top_hashtags</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>ecuadoresprovida           307
salvemoslas2vidas          242
ecuador                    176
provida                    118
escudero                    89
abortoporviolacion          78
ecuadorporlafamilia         70
aborto                      63
coip                        58
asambleistaqueserespeta     57
leyabortistano              56
marthavillafuerte           46
escudera                    44
votoprovida2021             42
escuderos                   40
conabortonotevoto           37
prolife                     36
chantajehumanitario         35
mentirasverdes              29
juntosporlafamilia          29
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> _FamiliaEcuador[<span class="st">'mentioned_names'</span>].to_list()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co"># remove nan items from list</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> users <span class="cf">if</span> <span class="kw">not</span> pd.isna(x)]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># split items into a list based on a delimiter</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> [x.split(<span class="st">'|'</span>) <span class="cf">for</span> x <span class="kw">in</span> users]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># flatten list of lists</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>users <span class="op">=</span> [item <span class="cf">for</span> sublist <span class="kw">in</span> users <span class="cf">for</span> item <span class="kw">in</span> sublist]</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co"># count items on list</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>users_count <span class="op">=</span> pd.Series(users).value_counts()</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>top_users <span class="op">=</span> users_count.nlargest(<span class="dv">10</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>top_users</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>asambleaecuador    332
hectoryepezm       145
justiciaan         134
etorrescobo        132
lenin              120
lourdescuestao     105
amishijoseduco      88
agustinlaje         77
amparo_medina       71
ecuadorprovida      71
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the data using plotly</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.line(_FamiliaEcuador, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>              x<span class="op">=</span><span class="st">'date'</span>, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>              y<span class="op">=</span><span class="st">'like_count'</span>, </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>              title<span class="op">=</span><span class="st">'Likes over Time'</span>,</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>              template<span class="op">=</span><span class="st">'plotly_dark'</span>, </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>              hover_data<span class="op">=</span>[<span class="st">'text'</span>])</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># show the plot</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>STOP_WORDS <span class="op">=</span> nlp.Defaults.stop_words</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_stopwords(text):</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    doc <span class="op">=</span> nlp(text.lower())</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    tokens <span class="op">=</span> [token.text <span class="cf">for</span> token <span class="kw">in</span> doc <span class="cf">if</span> <span class="kw">not</span> token.is_stop <span class="kw">and</span> token.text <span class="kw">not</span> <span class="kw">in</span> STOP_WORDS <span class="kw">and</span> token.is_alpha]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">' '</span>.join(tokens)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'preprocess'</span>] <span class="op">=</span> _FamiliaEcuador[<span class="st">'text'</span>].<span class="bu">apply</span>(filter_stopwords)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>token_counts <span class="op">=</span> _FamiliaEcuador[<span class="st">"preprocess"</span>].<span class="bu">str</span>.split(expand<span class="op">=</span><span class="va">True</span>).stack().value_counts()[:<span class="dv">20</span>]</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>token_counts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>vida                562
aborto              378
familia             354
ecuadoresprovida    316
gracias             305
ecuador             299
provida             218
apoyo               152
mujeres             139
violaci√≥n           131
ni√±os               120
nacer               119
hijos               119
concepci√≥n          118
causa               116
ley                 115
mujer               112
escudero            112
the                 108
voz                 108
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'hour'</span>] <span class="op">=</span> _FamiliaEcuador[<span class="st">'time'</span>].<span class="bu">str</span>.split(<span class="st">":"</span>).<span class="bu">str</span>[<span class="dv">0</span>]</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>hours_count <span class="op">=</span> _FamiliaEcuador[<span class="st">'hour'</span>].value_counts()</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>top_hours <span class="op">=</span> hours_count.nlargest(<span class="dv">15</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>top_hours</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>hour
17    206
20    193
14    183
13    175
15    175
21    173
18    172
16    168
19    156
22    149
04    148
03    136
23    128
02    101
12    100
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'source_name'</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>source_name
Twitter for Android    2398
Twitter Web App         151
Twitter Web Client      120
Twitter for iPhone       17
Instagram                17
TweetDeck                13
Name: count, dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove urls</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>p.set_options(p.OPT.URL)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'text_clean'</span>] <span class="op">=</span> _FamiliaEcuador[<span class="st">'text'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: p.clean(x))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Tokenize mentions and hashtags</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>p.set_options(p.OPT.MENTION)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'text_clean'</span>] <span class="op">=</span> _FamiliaEcuador[<span class="st">'text_clean'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: p.tokenize(x))</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace emojis with descriptions</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>_FamiliaEcuador[<span class="st">'text_clean'</span>] <span class="op">=</span> _FamiliaEcuador[<span class="st">'text_clean'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: demojize(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>docs <span class="op">=</span> _FamiliaEcuador[<span class="st">'preprocess'</span>]</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>topic_model <span class="op">=</span> BERTopic(language<span class="op">=</span><span class="st">"multilingual"</span>, calculate_probabilities<span class="op">=</span><span class="va">True</span>, verbose<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>topics, probs <span class="op">=</span> topic_model.fit_transform(docs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<script type="application/vnd.jupyter.widget-view+json">
{"model_id":"634ca9382ef54cd386498ef31b377d9b","version_major":2,"version_minor":0,"quarto_mimetype":"application/vnd.jupyter.widget-view+json"}
</script>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-06-29 16:02:32,583 - BERTopic - Transformed documents to Embeddings
2023-06-29 16:02:42,587 - BERTopic - Reduced dimensionality
2023-06-29 16:02:42,954 - BERTopic - Clustered reduced embeddings</code></pre>
</div>
</div>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>freq <span class="op">=</span> topic_model.get_topic_info()<span class="op">;</span> freq.head(<span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Topic</th>
<th data-quarto-table-cell-role="th">Count</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Representation</th>
<th data-quarto-table-cell-role="th">Representative_Docs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-1</td>
<td>931</td>
<td>-1_vida_ecuadoresprovida_ecuador_familia</td>
<td>[vida, ecuadoresprovida, ecuador, familia, pro...</td>
<td>[familiaecuador esteban torres pa√≠ses minister...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0</td>
<td>209</td>
<td>0_lunes_martes__</td>
<td>[lunes, martes, , , , , , , , ]</td>
<td>[, martes, lunes]</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1</td>
<td>144</td>
<td>1_aborto_mujeres_abortoporviolacion_cifras</td>
<td>[aborto, mujeres, abortoporviolacion, cifras, ...</td>
<td>[familiaecuador a√±o defender vida concepci√≥n m...</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>2</td>
<td>96</td>
<td>2_gracias_felicitaciones_estimada_saludos</td>
<td>[gracias, felicitaciones, estimada, saludos, a...</td>
<td>[felicitaciones estimada, felicitaciones minis...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>3</td>
<td>91</td>
<td>3_hijos_sociedad_familia_valores</td>
<td>[hijos, sociedad, familia, valores, padres, ed...</td>
<td>[familiaecuador basta comisi√≥n permanente ni√±e...</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>topic_model.visualize_topics()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>topic_model.update_topics(docs, n_gram_range<span class="op">=</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>topic_model.reduce_topics(docs, nr_topics<span class="op">=</span><span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>2023-06-29 16:03:08,162 - BERTopic - Reduced number of topics from 45 to 11</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>&lt;bertopic._bertopic.BERTopic at 0x7ff24a223460&gt;</code></pre>
</div>
</div>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>topic_model.visualize_topics()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>
<div class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>tweets <span class="op">=</span> _FamiliaEcuador[<span class="st">'text_clean'</span>].to_list()</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>timestamps <span class="op">=</span> _FamiliaEcuador[<span class="st">'local_time'</span>].to_list()</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>topics_over_time <span class="op">=</span> topic_model.topics_over_time(docs<span class="op">=</span>tweets, </span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>                                                timestamps<span class="op">=</span>timestamps, </span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>                                                global_tuning<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>                                                evolution_tuning<span class="op">=</span><span class="va">True</span>, </span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>                                                nr_bins<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>topic_model.visualize_topics_over_time(topics_over_time, top_n_topics<span class="op">=</span><span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>20it [00:02,  9.44it/s]</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>Unable to display output for mime type(s): application/vnd.plotly.v1+json</code></pre>
</div>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>